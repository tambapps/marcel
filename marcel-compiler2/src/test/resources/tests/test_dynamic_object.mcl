import static org.junit.jupiter.api.Assertions.assertEquals
import static org.junit.jupiter.api.Assertions.assertNull
import static org.junit.jupiter.api.Assertions.assertTrue
import static org.junit.jupiter.api.Assertions.assertFalse

dynobj o = 1
assertEquals(4, (o + 3).value)

o = DynamicObject.of(['foo': 1])
o['bar'] = 2
assertEquals(2, o.getAt('bar').value)
assertEquals(2, o['bar'].value)
assertEquals(['foo': 1, 'bar': 2], o.value)
assertTrue(o as bool)

o = new DynImpl()


class DynImpl implements DynamicObject {

  String name

  fun dynobj setProperty(String name, dynobj o) {
    if (name == "name") this.name = o?.value?.toString()
    return null
  }

  fun dynobj getProperty(String name) {
    return name == "name" ? DynamicObject.of(this.name) : null
  }

  fun dynobj invokeMethod(String name, Object[] args) {
      return DynamicObject.of(name)
  }

  fun Object getValue() {
    return name
  }

  fun bool isTruthy() {
    return false
  }
}